<!-- This file is broken into multiple templates. 
    -communityCarouselEvents is a temporary template replicating the community tabs for containing purposes.
    -carousel is the template for containing the event data.
    -event is a the content of a given event
    -calendaritems (Contains the slightly modified view of each element [Could be broken down into single template w/conditionals:])
        -today
        -past-event
        -upcoming-event
-->

<template name="communityCarouselEvents">
    <section class="community tabs tabs-bottom" id="{{anchor name=name}}" data-id="{{_id}}">
        <main>
            <!--Important that the article has a class of carousel-->
            <article class="active carousel">
                {{> calendar}}
            </article>
            <article>
                Another tab
            </article>
            <article>
                Another tab
            </article>
        </main>
        <menu class="tabs">
            <ul>
                <li class="active">Events</li>
                <li>Advocacy</li>
                <li>Evaluation</li>
            </ul>
        </menu>
        <!--Carousel: Not sure where this technically should technically live. I simply have it toggled via display block/none for now -->
        {{> carousel}}
    </section>
</template>


<template name="carousel">
    <section class="carousel events">
        <main>
            <!--First one needs active class-->          
            {{> eventDetailActive}}
            {{> eventDetail}}
            {{> eventDetail}}
        </main>
        <nav>
            <ul>
                <li class="prev">&#9664;</li>
                <li class="next">&#9658;</li>
                <li class="close-carousel">&#xf00d;</li>
            </ul>
        </nav>
    </section>

    <script>
        $('.carousel nav li').click(function(){
            var left = parseInt($('.carousel main').css('left'));
            var carouselWidth = $('.carousel main').width();
            if($(this).hasClass('prev')){
                if(left == 0 ){
                    // do nothing
                }
                else { 
                    var prevLeft = left + carouselWidth;
                    $('.carousel main').css({left: prevLeft});
                }
            }
            if($(this).hasClass('next')){
                if(left == - $('.carousel main article').length * carouselWidth + carouselWidth){
                    // do nothing
                }
                else { 
                    var nextLeft = left - carouselWidth;
                    $('.carousel main').css({left: nextLeft});
                }
            }
        });
        $('.details-ref').click(function(){
            $('.carousel').addClass('active');
         });
        $('.close-carousel').click(function(){
            $('.carousel').removeClass('active');
         });
    </script>
</template>
