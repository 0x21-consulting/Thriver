<template name="providerMap">
    <div id="map-canvas"></div>
    <script>
        // Map Initializer
        function initialize() {
            // Map Options
            var mapOptions = {
                scrollwheel: false,
                zoom: 12,
                center: new google.maps.LatLng(43.1, -89.4)
            }

            var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
            setMarkers(map, provider);
        }

        // List of Providers on given map
        var provider = [
            //Name, Lat, Lng, zIndex, ID
            ['Starbucks', 43.15, -89.4, 1, 0],
            ['Colectivo', 43.09, -89.5, 2, 1],
            ['Valentine', 43.07, -89.4, 3, 2],
        ];

        function setMarkers(map, locations) {

            //SVG Marker Pin
            var markerPin = {
                path: 'M 24,4.1C21.2,1.4,17.9,0,14,0c-3.9,0-7.2,1.4-9.9,4.1C1.4,6.9,0,10.2,0,14c0,2,0.3,3.6,0.9,4.9l10,21.2c0.3,0.6,0.7,1.1,1.3,1.4c0.6,0.3,1.2,0.5,1.9,0.5c0.7,0,1.3-0.2,1.9-0.5c0.6-0.3,1-0.8,1.3-1.4l10-21.2c0.6-1.3,0.9-2.9,0.9-4.9C28.1,10.2,26.7,6.9,24,4.1L24,4.1z M19,19c-1.4,1.4-3,2.1-5,2.1c-1.9,0-3.6-0.7-5-2.1C7.7,17.6,7,16,7,14c0-1.9,0.7-3.6,2.1-5c1.4-1.4,3-2.1,5-2.1c1.9,0,3.6,0.7,5,2.1c1.4,1.4,2.1,3,2.1,5C21.1,16,20.4,17.6,19,19L19,19z M19,19',
                fillColor: '#f56f76',
                fillOpacity: 1,
                scale: 1,
                //shape: shape,
                strokeWeight: 0,
                // Pin Position/Offset Controls
                size: new google.maps.Size(29, 43),
                origin: new google.maps.Point(0,0),
                anchor: new google.maps.Point(14, 43)
            };

            //Probably a better way to do this. Only difference as above pin is changed fillColor
            var markerPinHover = {
                path: 'M 24,4.1C21.2,1.4,17.9,0,14,0c-3.9,0-7.2,1.4-9.9,4.1C1.4,6.9,0,10.2,0,14c0,2,0.3,3.6,0.9,4.9l10,21.2c0.3,0.6,0.7,1.1,1.3,1.4c0.6,0.3,1.2,0.5,1.9,0.5c0.7,0,1.3-0.2,1.9-0.5c0.6-0.3,1-0.8,1.3-1.4l10-21.2c0.6-1.3,0.9-2.9,0.9-4.9C28.1,10.2,26.7,6.9,24,4.1L24,4.1z M19,19c-1.4,1.4-3,2.1-5,2.1c-1.9,0-3.6-0.7-5-2.1C7.7,17.6,7,16,7,14c0-1.9,0.7-3.6,2.1-5c1.4-1.4,3-2.1,5-2.1c1.9,0,3.6,0.7,5,2.1c1.4,1.4,2.1,3,2.1,5C21.1,16,20.4,17.6,19,19L19,19z M19,19',
                fillColor: 'black',
                fillOpacity: 1,
                scale: 1,
                //shape: shape,
                strokeWeight: 0,
                // Pin Position/Offset Controls
                size: new google.maps.Size(29, 43),
                origin: new google.maps.Point(0,0),
                anchor: new google.maps.Point(14, 43)
            };

            for (var i = 0; i &lt; locations.length; i++) {
                var provider = locations[i];
                var myLatLng = new google.maps.LatLng(provider[1], provider[2]);
                var marker = new google.maps.Marker({
                    position: myLatLng,
                    map: map,
                    icon: markerPin,
                    animation: google.maps.Animation.DROP,
                    title: provider[0],
                    zIndex: provider[3]
                });

                providerTitle(marker, i);

                
            }

            //Hover Effects
            // Thoughts on a quick way to get this to only affect the hovered element? 
            //Only seems to be affecting the first instance.
            google.maps.event.addListener(marker, 'mouseover', function() {
                marker.setIcon(markerPinHover, this);
            });

            google.maps.event.addListener(marker, 'mouseout', function() {
              marker.setIcon(markerPin, this);
            });
        }

        //Display a label next to the marker
        function providerTitle(marker, num) {
            var providerName = ['Starbucks', 'Colectivo', 'Valentine'];
            var infowindow = new google.maps.InfoWindow({
                content: '<p class="providerTitle">' + providerName[num] + '</p>'
            });

            //This bit here and the trigger click below were the best method I could find to display the infowindow on load.
            //I'd like to style this more: if we could say something like $(providerTitle).parent.parent.parent.parent.addClass('bubble' I could completely restyle the bubble and relocate the text)
            google.maps.event.addListener(marker, 'click', function() {
                infowindow.open(marker.get('map'), marker);
            });
            google.maps.event.trigger(marker,'click');
        }

        // Load the Map
        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
</template>