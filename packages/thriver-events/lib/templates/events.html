<!--Note that li.eventSlide requires a value=# which matches that of it's cooresponding calendar listing: '.eventDate'. values should start at 0-->

<template name="events">
    <section class="events mainSection" id="{{anchor name=name}}" data-id="{{_id}}">
        {{#if isAdmin}}
            {{> sectionAdmin}}
        {{/if}}
        <div class="containerSmall">
            <header>
                <h1>Events</h1>
                <p>WCASA caters its events toward the needs of its membership <br>
                    and the service providers of the state as a whole. <br>
                    Check back often to find events year-round.
                </p>
            </header>
        </div>
        <div class="eventsContainer">
            <aside class="eventsSidebar">
                <h2 class="sidebarHeader">Events Calendar</h2>
                {{>calendar}}
                <h2 class="sidebarHeader">Upcoming Events</h2>
                {{>upcomingEvents}}
            </aside>
            <div class="eventsMain main">
                <header class="eventsHeader">
                    <ul>
                        <li class="scroll-prev-month preventSelect">
                            <span class="fa">&#xf137;</span> {{lastMonth}}</li>
                        <li class="scroll-next-month preventSelect">{{nextMonth}}
                            <span class="fa">&#xf138;</span></li>
                        {{#if isAdmin}}
                            <li class="addEvent" title="Add an Event">
                                <span class="fa">&#xf055;</span> Add Event</li>
                        {{/if}}
                        <li class="search"><span class="fa">&#xf002;</span><input type="search"></li>
                        <li class="mobile back-to-events">
                            <button><span class="fa">&#xf137;</span> Back to Events</button></li>
                    </ul>
                </header>
                <div class="eventsSlider">
                    <button class="sliderPrev fa">&#xf053;</button>
                    <div class="slideScroller">
                        <ul class="slides" id="slidesList">
                            {{#if events}}
                                {{#each events}}
                                    {{> eventSlide}}
                                {{/each}}
                            {{/if}}
                        </ul>
                    </div>
                    <button class="sliderNext fa">&#xf054;</button>
                </div>
                {{#if isAdmin}}
                    {{> eventsAdmin}}
                {{/if}}
            </div>
        </div>
    </section>
</template>


<template name="eventSlide">
    <li class="eventSlide">
        <div class="eventContainer">
            <div class="inner">
                <header>
                    <p class="eventDate">{{startDate}}</p>
                    {{ #if numberSameDayEvents }}
                        <aside class="otherEvents">
                        {{ #if isSingular }}
                            There is one other event on this date:
                        {{ else }}
                            There are {{ numberSameDayEvents }} other events on this date:
                        {{/if}}
                            <ul>
                                {{#each sameDayEvents}}
                                <li><a href="#">{{name}}</a></li>
                                {{/each}}
                            </ul>
                        </aside>
                    {{/if}}
                </header>
                <div class="main">
                    <h2>{{name}}
                        {{#if isAdmin}}
                            <aside class="adminControls">
                                <span class="fa edit" title="Edit Event">&#xf044;</span>
                                <span class="fa delete" title="Delete Event">&#xf014;</span>
                            </aside>
                        {{/if}}
                    </h2>
                    <p class="excerpt">
                        <b>{{startTime}}{{endTime}}: {{{ address }}}</b>
                    </p>
                    {{{ markdown description }}}
                </div>
                <ul class="actions">
                    <li class="register">Register</li>
                    {{!<li class="details">Read More <span class="fa">&#xf0da;</span></li>}}
                </ul>
            </div>
        </div>
    </li>
</template>




<template name="upcomingEvents">
        <ul class="upcomingEvents">
            {{ #each upcomingEvents }}
                {{>upcomingEventListItem}}
            {{/each}}
            <li class="no-upcoming-list">
                There are currently no upcoming event<br>
                Be sure to check back later!
            </li>
        </ul>
    <!--<button class="seeAllEvents">See All Upcoming <span class="fa">&#xf13a;</span></button>-->
</template>

<template name="upcomingEventListItem">
    <li>
        <h3>
            <a class="eventDate" href="#" data-id="{{_id}}">
             {{ friendlyDate }} &mdash; {{ name }}
            </a>
        </h3>
        <ul class="actions">
            <!--{{>actionRegisterPrompt}}-->
            <!--{{>actionUnregisterPrompt}}-->
            <!--{{>actionRegistered}}-->
            <!--{{>actionNotRegistered}}-->
            <!--{{>actionNotLoggedIn}}-->
        </ul>
    </li>
</template>

<template name="actionRegistered">
    <li class="registered info">You are currently registered for this event.</li>
    <li class="view action"><a href="#" class="eventDate" data-value="2">View Event</a></li>
    <li class="unregister action"><a href="#">Unregister</a></li>
</template>

<template name="actionNotRegistered">
    <li class="view action"><a href="#" class="eventDate" data-value="2">View Event</a></li>
    <li class="register action"><a href="#">Register</a></li>
</template>

<template name="actionUnregisterPrompt">
    <li class="noRegistered info">You have been unregistered for this event.</li>
</template>

<template name="actionRegisterPrompt">
    <li class="justRegistered info">You are now registered for this event.</li>
</template>

<template name="actionNotLoggedIn">
    <li class="notAccount info">
        <a href="#" class="login">Login</a> or <a href="#" class="create">Create an Account</a> to register for this event.
    </li>
    <li class="view action"><a href="#" class="eventDate" data-value="2">View Event</a></li>
</template>

<template name="eventSummary">
    <span class="eventSummary">
        <ul>
            {{#each this}}
                <li>{{name}}</li>
            {{/each}}
        </ul>
    </span>
</template>


<template name="calendar">
    <div id="calendar" class="calendar">
        <h2>
            <span class="fa prevMonth monthPaginate">&#xf0d9;</span>
            {{getMonth}} {{getYear}}
            <span class="fa nextMonth monthPaginate">&#xf0da;</span>
        </h2>
        <!--Days-->
        <span class="weekday">S</span>
        <span class="weekday">M</span>
        <span class="weekday">T</span>
        <span class="weekday">W</span>
        <span class="weekday">T</span>
        <span class="weekday">F</span>
        <span class="weekday">S</span>
        <!--Days End-->

        {{#each week}}
            {{#each this}}
                <span class="{{notCurrent}} {{currentWeekStart}} {{today}} {{hasEvent}} {{past}}">
                    {{#if hasEvent}}
                        <button data-id="{{id}}" class="eventDate">
                            {{date}}
                            {{> eventSummary currentEvents}}
                        </button>
                    {{else}}
                        {{date}}
                    {{/if}}
                </span>
            {{/each}}
        {{/each}}

        <div style="clear:both;"></div>
    </div>
</template>


<template name="noEvents">
    <li class="eventSlide">
        <div class="eventContainer">
            <div class="inner">
                <header>
                    <p>Woops! No events this month!</p>
                </header>
            </div>
        </div>
    </li>
</template>